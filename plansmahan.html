<!doctype html>
<html lang="fa" dir="rtl">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Mahan Shop — پلن‌ها</title>
<link href="https://fonts.googleapis.com/css2?family=Vazirmatn:wght@400;600;700&display=swap" rel="stylesheet">
<style>
  :root{
    --bg:#050617;--card:rgba(255,255,255,0.03);
    --accent1:#7c4dff;--accent2:#00d4ff;--muted:rgba(255,255,255,0.6);
    --ok:#00ff9b;--warn:#ffb86b;
  }
  *{box-sizing:border-box;font-family:Vazirmatn, sans-serif}
  body{margin:0;background:linear-gradient(180deg,#040416,#07102a);color:#eef2ff;padding:18px}
  header{display:flex;justify-content:space-between;align-items:center;padding:12px;background:rgba(255,255,255,0.02);border-radius:10px}
  header h1{margin:0;font-size:18px}
  nav a{color:var(--accent2);text-decoration:none;margin-left:12px;font-weight:700}
  .container{max-width:1100px;margin:20px auto;display:grid;grid-template-columns:1fr 360px;gap:18px}
  @media(max-width:980px){.container{grid-template-columns:1fr}}
  .card{background:var(--card);padding:14px;border-radius:12px;border:1px solid rgba(255,255,255,0.03)}
  .choose{display:flex;gap:10px;align-items:center;margin-bottom:12px;flex-wrap:wrap}
  select{padding:8px;border-radius:8px;background:transparent;border:1px solid rgba(255,255,255,0.04);color:inherit}
  .accordion {display:flex;flex-direction:column;gap:8px}
  .section {border-radius:10px;padding:10px;background:linear-gradient(180deg,rgba(255,255,255,0.01),transparent);cursor:pointer;border:1px solid rgba(255,255,255,0.03)}
  .section .title{display:flex;justify-content:space-between;align-items:center;font-weight:800}
  .section .items{display:none;margin-top:10px;gap:8px;flex-direction:column}
  .item{display:flex;justify-content:space-between;align-items:center;padding:10px;border-radius:8px;background:rgba(0,0,0,0.4)}
  .item .left{max-width:70%}
  .btn{padding:8px 12px;border-radius:8px;border:none;background:linear-gradient(90deg,var(--accent1),var(--accent2));color:#07101a;font-weight:800;cursor:pointer}
  .btn.ghost{background:transparent;border:1px solid rgba(255,255,255,0.04);color:var(--muted)}
  .unavailable{opacity:0.45;color:var(--warn);font-weight:900}
  .sidebar{display:flex;flex-direction:column;gap:12px}
  .wallet{font-weight:800;direction:ltr}
  .copy{padding:8px;border-radius:8px;border:none;background:linear-gradient(90deg,var(--accent2),var(--accent1));color:#07101a;cursor:pointer}
  .note{font-size:13px;color:var(--muted)}
</style>
</head>
<body>
  <header>
    <h1>Mahan Shop — فروش سرویس‌های تلگرامی</h1>
    <nav>
      <a href="index.html">خانه</a>
      <a href="plansmahan.html">پلن‌ها</a>
      <a href="paymentmahan.html">پرداخت</a>
      <a href="support.html">پشتیبانی</a>
    </nav>
  </header>

  <div class="container">
    <div>
      <div class="card">
        <div style="display:flex;justify-content:space-between;align-items:center">
          <div>
            <h2 style="margin:0">انتخاب سرویس</h2>
            <div class="note">ابتدا دستهٔ سرویس را انتخاب کن تا گزینه‌ها باز شوند.</div>
          </div>
        </div>

        <div class="choose" style="margin-top:12px">
          <label style="font-weight:800">دسته:</label>
          <select id="categorySelect">
            <option value="">— انتخاب کنید —</option>
            <option value="stars">استارز تلگرام</option>
            <option value="premium">تلگرام پرمیوم</option>
            <option value="boosts">بوست کانال</option>
            <option value="instagram">اینستاگرام (ویو/لایک/فالو)</option>
            <option value="telegram_services">تلگرام (ممبر/ویو)</option>
            <option value="virtual_numbers">شماره مجازی</option>
          </select>

          <div style="margin-left:auto" class="note">آدرس کیف پول: <code id="wallet">UQDX39uC54HfFIIynuSX2XPpr-dwnF5KznTOwHkrKoUbYhFI</code></div>
        </div>

        <div id="accordion" class="accordion" style="margin-top:12px">
          <!-- sections inserted by JS -->
        </div>
      </div>
    </div>

    <aside class="sidebar">
      <div class="card">
        <div style="display:flex;justify-content:space-between;align-items:center">
          <div>
            <div class="note">کیف پول (TRON)</div>
            <div class="wallet" id="walletAddr">UQDX39uC54HfFIIynuSX2XPpr-dwnF5KznTOwHkrKoUbYhFI</div>
          </div>
          <button class="copy" id="copyWallet">کپی</button>
        </div>

        <div style="margin-top:12px">
          <div class="note">قیمت تبدیل (زنده)</div>
          <div id="rates" class="note">در حال دریافت نرخ‌ها…</div>
        </div>

        <div style="margin-top:12px" class="note">
          بعد از انتخاب محصول، روی «پرداخت» کلیک کن — به صفحهٔ پرداخت هدایت می‌شوی و مبلغ به تومان + معادل کریپتو نمایش داده می‌شود.
        </div>
      </div>
    </aside>
  </div>

<script>
/* ---------- data ---------- */
const DATA = {
  stars:[
    {id:'s50', title:'50 استارز', price:112000},
    {id:'s75', title:'75 استارز', price:170000},
    {id:'s100', title:'100 استارز', price:229000},
    {id:'s250', title:'250 استارز', price:562000},
    {id:'s500', title:'500 استارز (تخفیف)', price:1055000},
    {id:'s750', title:'750 استارز (تخفیف)', price:1560000},
    {id:'s1000', title:'1000 استارز (تخفیف)', price:2080000},
    {id:'s2500', title:'2500 استارز (تخفیف)', price:4990000}
  ],
  premium:[
    {id:'p1', title:'پرمیوم 1 ماه', price:null, note:'—'},
    {id:'p3', title:'پرمیوم 3 ماه', price:1693000},
    {id:'p6', title:'پرمیوم 6 ماه', price:2197000},
    {id:'p12', title:'پرمیوم 12 ماه', price:3695000}
  ],
  boosts:[
    {id:'b7', title:'بوست 7 روزه', price:22000},
    {id:'b15', title:'بوست 15 روزه', price:24000},
    {id:'b30', title:'بوست 30 روزه', price:50000}
  ],
  instagram:[
    {id:'ig_view', title:'ویو فیک (هر 1000)', price:3000, per:'1000'},
    {id:'ig_like', title:'لایک فیک 1000 عدد', price:86000},
    {id:'ig_follow', title:'فالور فیک (هر 1000)', price:270000, per:'1000'}
  ],
  telegram_services:[
    {id:'tg_member', title:'ممبر فیک (هر 1000)', price:64000, per:'1000'},
    {id:'tg_view', title:'ویو فیک تلگرام (هر 1000)', price:1000, per:'1000'}
  ],
  virtual_numbers:[
    {id:'num_us', title:'آمریکا', price:45000},
    {id:'num_de', title:'آلمان', price:370000},
    {id:'num_es', title:'اسپانیا', price:370000},
    {id:'num_it', title:'ایتالیا', price:370000},
    {id:'num_np', title:'نپال', price:55000},
    {id:'num_bd', title:'بنگلادش', price:60000},
    {id:'num_pk', title:'پاکستان', price:55000},
    {id:'num_ag', title:'آتاگولا', price:50000},
    {id:'num_af', title:'افغانستان', price:70000},
    {id:'num_zm', title:'زامبیا', price:68000},
    {id:'num_eg', title:'مصر', price:80000},
    {id:'num_sy', title:'سوریه', price:100000},
    {id:'num_ye', title:'یمن', price:100000},
    {id:'num_in', title:'هند', price:70000},
    {id:'num_cn', title:'چین', price:130000}
  ],
  // special Vitory extra items (نامحدود)
  vitory_extra:[
    {id:'v_unl_1m', title:'نامحدود — 1 ماه', price:110000, available:false},
    {id:'v_unl_2m', title:'نامحدود — 2 ماه', price:200000, available:true}
  ]
};

/* ---------- UI ---------- */
const categorySelect = document.getElementById('categorySelect');
const accordion = document.getElementById('accordion');
const ratesEl = document.getElementById('rates');

let rates = {usd_per_irr: null, usdt_usd:1, trx_usd:0.28}; // will fetch

// helper format
function fmtT(n){ return (n||0).toLocaleString('fa-IR') + ' تومان'; }
function createSection(title, items){
  const s = document.createElement('div'); s.className='section';
  s.innerHTML = `<div class="title"><div>${title}</div><div style="opacity:0.8">نمایش ▼</div></div>
    <div class="items"></div>`;
  const itemsEl = s.querySelector('.items');
  items.forEach(it=>{
    const item = document.createElement('div'); item.className='item';
    const left = document.createElement('div'); left.className='left';
    left.innerHTML = `<div style="font-weight:800">${it.title}</div>${it.note?'<div class="note">'+it.note+'</div>':''}`;
    const right = document.createElement('div');
    if(it.available===false){
      right.innerHTML = `<div class="unavailable">ناموجود</div>`;
    } else {
      right.innerHTML = `<div style="text-align:right">${it.price?fmtT(it.price):'—'}</div>
        <div style="margin-top:8px"><button class="btn" data-id="${it.id}" data-price="${it.price||''}" data-title="${it.title}">پرداخت / انتخاب</button></div>`;
    }
    item.appendChild(left); item.appendChild(right);
    itemsEl.appendChild(item);
  });
  // toggle
  s.addEventListener('click', (e)=>{
    // avoid toggling when clicking button
    if(e.target.tagName.toLowerCase()==='button') return;
    const visible = itemsEl.style.display === 'flex';
    itemsEl.style.display = visible ? 'none' : 'flex';
    itemsEl.style.flexDirection = 'column';
  });
  return s;
}

// render selected category
function renderCategory(cat){
  accordion.innerHTML = '';
  if(!cat) return;
  if(cat === 'stars') accordion.appendChild(createSection('خرید استارز تلگرام', DATA.stars));
  if(cat === 'premium') accordion.appendChild(createSection('تلگرام پرمیوم', DATA.premium));
  if(cat === 'boosts') accordion.appendChild(createSection('بوست کانال', DATA.boosts));
  if(cat === 'instagram') accordion.appendChild(createSection('خدمات اینستاگرام', DATA.instagram));
  if(cat === 'telegram_services') accordion.appendChild(createSection('خدمات تلگرام', DATA.telegram_services));
  if(cat === 'virtual_numbers') accordion.appendChild(createSection('شماره‌های مجازی', DATA.virtual_numbers));

  // If vitory extras desired: show as additional section under stars (or as separate)
  // Here we'll append vitory_extra always as special card
  const vit = createSection('Vitory — محصولات ویژه', DATA.vitory_extra);
  accordion.appendChild(vit);

  // attach buttons
  accordion.querySelectorAll('button.btn').forEach(b=>{
    b.addEventListener('click', ()=>{
      const id = b.dataset.id;
      const price = b.dataset.price;
      const title = b.dataset.title;
      // open payment page with query params: plan & amount & name=MAHAN
      const url = new URL('paymentmahan.html', window.location.href);
      url.searchParams.set('plan', title);
      if(price) url.searchParams.set('amount', price);
      window.location.href = url.toString();
    });
  });
}

/* ---------- copy wallet ---------- */
document.getElementById('copyWallet').addEventListener('click', async ()=>{
  const w = document.getElementById('walletAddr').textContent.trim();
  await navigator.clipboard.writeText(w);
  alert('آدرس کیف پول کپی شد ✅');
});

/* ---------- category change ---------- */
categorySelect.addEventListener('change', ()=> renderCategory(categorySelect.value));

/* ---------- fetch live rates (CoinGecko + exchangerate host) ---------- */
async function fetchRates(){
  try{
    // CoinGecko simple price for TRX and USDT in USD
    const coingecko = await fetch('https://api.coingecko.com/api/v3/simple/price?ids=tron,tether&vs_currencies=usd').then(r=>r.json());
    const trx_usd = coingecko.tron.usd || 0.28;
    const usdt_usd = coingecko.tether.usd || 1.0;

    // exchangerate.host for IRR -> USD (1 IRR = x USD)
    const ex = await fetch('https://api.exchangerate.host/latest?base=IRR&symbols=USD').then(r=>r.json());
    // ex.rates.USD is how many USD per 1 IRR
    const usd_per_irr = ex && ex.rates && ex.rates.USD ? ex.rates.USD : 0.0000237;

    rates = {usd_per_irr, usdt_usd, trx_usd};
    ratesEl.textContent = `1 TRX ≈ $${trx_usd.toFixed(4)} — 1 USDT ≈ $${usdt_usd.toFixed(4)} — نرخ IRR→USD: ${usd_per_irr.toExponential(6)}`;
  }catch(err){
    ratesEl.textContent = 'خطا در دریافت نرخ‌ها — اتصال اینترنت را بررسی کن';
  }
}
fetchRates();
</script>
</body>
</html>
