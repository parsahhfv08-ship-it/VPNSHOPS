<!doctype html>
<html lang="fa" dir="rtl">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>پرداخت و ارسال رسید — VPN SHOP</title>
  <link href="https://fonts.googleapis.com/css2?family=Vazirmatn:wght@400;700&display=swap" rel="stylesheet">
  <style>
    :root{--bg:#070816;--accent1:#7c4dff;--accent2:#00d4ff}
    html,body{height:100%;margin:0;font-family:Vazirmatn;background:linear-gradient(180deg,var(--bg),#021026);color:#eef2ff}
    header{padding:12px;border-bottom:1px solid rgba(255,255,255,0.03)}
    nav a{color:var(--accent2);text-decoration:none;margin:0 8px;font-weight:700}
    .wrap{max-width:820px;margin:36px auto;padding:16px}
    .box{background:rgba(255,255,255,0.03);padding:18px;border-radius:12px}
    .row{display:flex;gap:12px;flex-wrap:wrap;align-items:center;justify-content:space-between}
    .cardnum, .amount{font-weight:800;direction:ltr}
    .copy{padding:10px 12px;border-radius:10px;border:none;background:linear-gradient(90deg,var(--accent1),var(--accent2));color:#07101a;cursor:pointer;font-weight:800}
    form{margin-top:14px;display:flex;flex-direction:column;gap:8px}
    input,textarea{padding:10px;border-radius:8px;border:none;background:rgba(255,255,255,0.06);color:inherit}
    button.submit{padding:12px;border-radius:10px;border:none;background:linear-gradient(90deg,var(--accent2),var(--accent1));color:#07101a;font-weight:900;cursor:pointer}
    .note{color:rgba(255,255,255,0.7);font-size:13px;margin-top:10px}
  </style>
</head>
<body>
  <header>
    <nav>
      <a href="index.html">خانه</a>
      <a href="plans.html">خرید VPN</a>
      <a href="payment.html">ارسال رسید</a>
      <a href="support.html">پشتیبانی</a>
      <a href="about.html">درباره ما</a>
    </nav>
  </header>

  <main class="wrap">
    <div class="box">
      <h2>ارسال رسید پرداخت</h2>
      <p class="note">بعد از کارت‌به‌کارت، تصویر رسید را در فرم زیر ارسال کن تا کانفیگ برایت فعال شود.</p>

      <div class="row">
        <div>
          <div class="small">شماره کارت (واریز به)</div>
          <div class="cardnum" id="cardnum">6037998174542638</div>
          <div class="small">به نام: پارسا عبدالملکی</div>
        </div>

        <div style="text-align:left">
          <div class="small">مبلغ پیشنهادی</div>
          <div class="amount" id="amountDisplay">40,000 تومان</div>
        </div>
      </div>

      <div style="margin-top:12px;display:flex;gap:8px;flex-wrap:wrap">
        <button class="copy" onclick="copyToClipboard(document.getElementById('cardnum').textContent)">📋 کپی شماره کارت</button>
        <button class="copy" id="copyAmountBtn">💰 کپی مبلغ</button>
      </div>

      <form id="receiptForm" class="box" style="margin-top:12px" action="https://formspree.io/f/xvgvvbqp" method="POST" enctype="multipart/form-data">
        <input type="hidden" name="plan" id="hfPlan" value="">
        <input type="hidden" name="amount" id="hfAmount" value="">
        <label>نام و نام خانوادگی (اختیاری)</label>
        <input name="name" type="text" placeholder="مثلاً علی رضایی">

        <label>شماره تماس (برای ارسال کانفیگ) *</label>
        <input name="phone" type="tel" placeholder="0912xxxxxxx" required>

        <label>عکس رسید (تصویر یا اسکرین‌شات) *</label>
        <input name="receipt" type="file" accept="image/*" required>

        <label>توضیحات (اختیاری)</label>
        <textarea name="message" rows="3" placeholder="مثلاً زمان پرداخت یا نام پرداخت‌کننده"></textarea>

        <button class="submit" type="submit">📤 ارسال رسید و ثبت سفارش</button>
        <div id="status" class="note"></div>
      </form>
    </div>
  </main>

  <script>
    // read query params to prefill amount & plan (from plans.html links)
    const qs = new URLSearchParams(location.search);
    const amt = qs.get('amount');
    const plan = qs.get('plan');
    if(amt){
      const n = parseInt(amt.replace(/[^\d]/g,''),10);
      if(!isNaN(n)) document.getElementById('amountDisplay').textContent = n.toLocaleString('fa-IR') + ' تومان';
      document.getElementById('hfAmount').value = n;
    }
    if(plan) document.getElementById('hfPlan').value = plan;

    // copy helpers
    function copyToClipboard(t){ navigator.clipboard.writeText(t).then(()=> alert("کپی شد ✅")); }
    document.getElementById('copyAmountBtn').addEventListener('click', ()=>{
      const txt = document.getElementById('hfAmount').value || document.getElementById('amountDisplay').textContent;
      navigator.clipboard.writeText(txt).then(()=> alert("مبلغ کپی شد ✅"));
    });

    // submit feedback: form will post to Formspree
    const form = document.getElementById('receiptForm');
    const status = document.getElementById('status');
    form.addEventListener('submit', async (e)=>{
      status.textContent='⏳ ارسال در حال انجام...';
      // let browser do POST (standard) — we can still show message after fetch for nicer UX
      // use fetch with FormData to show status without page reload
      e.preventDefault();
      const fd = new FormData(form);
      try{
        const res = await fetch(form.action, {method:'POST', body:fd, headers:{Accept:'application/json'}});
        if(res.ok){ status.textContent='✅ رسید ارسال شد. پس از بررسی کانفیگ فعال خواهد شد.'; form.reset(); }
        else { status.textContent='⚠️ مشکلی پیش آمده؛ دوباره تلاش کن.'; }
      }catch(err){ status.textContent='⚠️ خطا در ارتباط؛ اینترنتت را چک کن.'; }
    });
  </script>
</body>
</html>